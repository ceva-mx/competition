datasource db {
  url      = env("DATABASE_URL")
  provider = "postgresql"
}

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "darwin-arm64"]
}

model User {
  uuid        String        @id
  email       String
  name        String
  Admin       Admin[]
  Participant Participant[]
}

model Participant {
  uuid            String       @id
  Result          Result[]
  User            User?        @relation(fields: [userUuid], references: [uuid], onDelete: SetNull)
  userUuid        String?
  Competition     Competition? @relation(fields: [competitionUuid], references: [uuid], onDelete: SetNull)
  competitionUuid String?
}

model Admin {
  uuid            String       @id
  User            User?        @relation(fields: [userUuid], references: [uuid], onDelete: SetNull)
  userUuid        String?
  Competition     Competition? @relation(fields: [competitionUuid], references: [uuid], onDelete: SetNull)
  competitionUuid String?
}

model Competition {
  uuid        String        @id
  name        String
  posterUrl   String
  description String
  link        String?
  isPublished Boolean       @default(false)
  Admin       Admin[]
  Participant Participant[]
  Route       Route[]
}

model Route {
  uuid            String       @id
  name            String
  category        String
  cost            Int
  Result          Result[]
  Competition     Competition? @relation(fields: [competitionUuid], references: [uuid], onDelete: SetNull)
  competitionUuid String?
}

model Result {
  uuid            String       @id
  finish          Int
  attempts        Int
  Route           Route?       @relation(fields: [routeUuid], references: [uuid], onDelete: SetNull)
  routeUuid       String?
  Participant     Participant? @relation(fields: [participantUuid], references: [uuid], onDelete: SetNull)
  participantUuid String?
}
